(()=>{"use strict";var e,t,n,a={8305:(e,t,n)=>{var a=n(7294),r=n(745),i=n(9250),l=n(932);const o=()=>{const e=Math.max(document.body.offsetWidth,document.documentElement.offsetWidth,document.body.clientWidth,document.documentElement.clientWidth),[t,n]=(0,a.useState)(e||769),r={isMicroMobile:t<=320,isMobile:t<=510,isTab:t>510&&t<821,isLaptop:t>820&&t<1440,isDesktop:t>=1440};return(0,a.useEffect)((()=>{c(n,new Event(""));const e=c.bind(void 0,n);return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[]),(0,a.useEffect)((()=>{r.isMicroMobile=t<=320,r.isMobile=t<=510,r.isTab=t>510&&t<821,r.isLaptop=t>820&&t<1440,r.isDesktop=t>=1440}),[t]),r};function c(e,t){e(Math.max(document.body.offsetWidth,document.documentElement.offsetWidth,document.body.clientWidth,document.documentElement.clientWidth))}var s=n(743);const m=s.v9,d=()=>(0,s.I0)();var u=n(4268);const p=(0,u.oM)({name:"activeSectionState",initialState:{section:"news",activeNews:null},reducers:{setSection:(e,t)=>{let{payload:n}=t;e.section=n},setActiveNews:(e,t)=>{let{payload:n}=t;e.activeNews=n}}}),{setSection:h,setActiveNews:f}=p.actions,g=p,v=(0,a.memo)((()=>{const e=d(),{Container:t,Item:n,IconBox:r,Icon:i,ItemText:c}=(()=>{const e=o();return{Container:l.Z.div({position:"absolute",bottom:"0vh",left:"0",height:"5em",maxHeight:"5em",width:"100vw",minHeight:"5em",display:"flex",justifyContent:"space-between",backgroundColor:"#E3E3E3",padding:"0.5rem 2rem",WebkitTapHighlightColor:"transparent",boxShadow:"0 0 5px 1px #00000010"}),Item:l.Z.div({display:"flex",flexDirection:"column",gap:"0em",alignItems:"center",justifyContent:"center",color:"#6E777F",transition:"0.3s","&.active":{color:"#000"}}),IconBox:l.Z.div({}),Icon:l.Z.div({fontSize:"2.5em",color:"inherit"}),ItemText:l.Z.div({fontWeight:600,fontSize:"0.875rem",color:"inherit"}),size:e}})(),s=m((e=>e.activeSectionState.section)),u=(0,a.useRef)(null),p=(0,a.useRef)(null),g=(0,a.useRef)(null);return(0,a.useEffect)((()=>{setTimeout((()=>{var e,t,n,a,r,i,l,o,c;"news"==s&&(null===(e=u.current)||void 0===e||e.classList.add("active"),null===(t=p.current)||void 0===t||t.classList.remove("active"),null===(n=g.current)||void 0===n||n.classList.remove("active"));"raiting"==s&&(null===(a=u.current)||void 0===a||a.classList.remove("active"),null===(r=p.current)||void 0===r||r.classList.add("active"),null===(i=g.current)||void 0===i||i.classList.remove("active"));"profile"==s&&(null===(l=u.current)||void 0===l||l.classList.remove("active"),null===(o=p.current)||void 0===o||o.classList.remove("active"),null===(c=g.current)||void 0===c||c.classList.add("active"))}),300)})),a.createElement(t,null,a.createElement(n,{ref:u,onClick:()=>{e(h("news")),e(f(null))}},a.createElement(r,null,a.createElement(i,{className:"icon-news"})),a.createElement(c,null,"Новости")),a.createElement(n,{ref:p,onClick:()=>{e(h("raiting"))}},a.createElement(r,null,a.createElement(i,{className:"icon-profile"})),a.createElement(c,null,"Рейтинг")),a.createElement(n,{ref:g,onClick:()=>{e(h("profile"))}},a.createElement(r,null,a.createElement(i,{className:"icon-raiting"})),a.createElement(c,null,"Профиль")))}),(()=>!0)),E=(0,u.oM)({name:"allertState",initialState:{allert:""},reducers:{setAllert:(e,t)=>{let{payload:n}=t;e.allert=n}}}),{setAllert:w}=E.actions,y=E,b=()=>{const e=m((e=>e.allertState.allert));return a.createElement("div",{id:"allertCopy",className:"copyAllert",style:{borderRadius:20,padding:"5px 15px",color:"#fff",backgroundColor:"#969696",position:"fixed",top:"90vh",left:"50%",minWidth:"15em",width:"fit-content",maxWidth:"90vw",textAlign:"center",whiteSpace:"nowrap",transform:"translate(-50%, -50%)",opacity:0,pointerEvents:"none",transition:"0.3s",zIndex:1e3}},e)};const x=()=>((0,a.useEffect)((()=>{const e=setInterval((()=>{window.Telegram.WebApp.expand();Z()?document.documentElement.style.setProperty("--ios-padding","110px"):document.documentElement.style.setProperty("--ios-padding","0px")}),500);return()=>{clearInterval(e)}}),[]),a.createElement(a.Fragment,null));function Z(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}const C=()=>{const e=d(),t=(0,i.s0)(),n=(0,i.TH)(),{activeNews:r,section:l}=m((e=>e.activeSectionState));return(0,a.useEffect)((()=>{"news"==l&&r&&e(f(null)),"/"==n.pathname?window.Telegram.WebApp.BackButton.hide():(window.Telegram.WebApp.BackButton.show(),window.Telegram.WebApp.BackButton.onClick((()=>{t("/")})))}),[n.pathname]),a.createElement(a.Fragment,null)},S=(0,u.oM)({name:"adminState",initialState:{locations:[],token:"",listNews:[]},reducers:{setAdminToken:(e,t)=>{let{payload:n}=t;document.cookie=`adminToken=${n}; path=/;`,e.token=n},setAdminLocation:(e,t)=>{let{payload:n}=t;e.locations=n},setAdminNewsList:(e,t)=>{let{payload:n}=t;e.listNews=n}}}),{setAdminToken:A,setAdminLocation:I,setAdminNewsList:k}=S.actions,z=S,T=()=>m((e=>e.authBlurState.blur))?a.createElement("div",{style:{width:"100%",height:"100%",position:"fixed",backgroundColor:"#fff",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3}},"Ваша кандидатура на рассмотрении"):a.createElement(a.Fragment,null),B=(0,a.createContext)({}),N=()=>{const{pathname:e}=(0,i.TH)();return e.includes("admin")&&(()=>{const e=d();let t=document.cookie.split(";").filter((e=>e.includes("adminToken")))[0];if(t){if(t=t.split("adminToken=")[1],""==t||"undefined"==t)return;e(A(t))}})(),(0,a.useEffect)((()=>{e.includes("admin")?document.body.setAttribute("style","background: #fff"):document.body.setAttribute("style","")})),a.createElement(B.Provider,{value:"val"},a.createElement(T,null),a.createElement(b,null),a.createElement(C,null),a.createElement(x,null),a.createElement(i.j3,null),e.includes("admin")?"":a.createElement(v,null))},j={avatarGray:"#"},D=()=>{const e=o(),{}=j,t=Z();return{Container:l.Z.div({position:"sticky",top:"10vh",left:"0",height:"calc(90vh - (5em + 1vh))",width:"100vw",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:t?"start":"center",gap:"3vh"}),size:e}},O=n.p+"50cc68feddee150d10d9.png",F=e=>{var t;let{item:n,full:r}=e;const i=d(),{Container:c,Image:s,TextBox:m,Title:u,Text:p,MainContent:h}=(()=>{const e=o();return{Container:l.Z.div({borderRadius:"10px",overflow:"hidden",minHeight:"fit-content"}),Image:l.Z.img({width:"100%",aspectRatio:"2.25/1"}),TextBox:l.Z.div({background:"#fff",display:"flex",flexDirection:"column",gap:"0.25em",padding:"1em"}),Title:l.Z.div({fontSize:"1.25em",fontWeight:600}),Text:l.Z.div({fontSize:"0.875em"}),MainContent:l.Z.div({fontSize:"0.875em"}),size:e}})();return a.createElement(c,{onClick:()=>{i(f(n))}},a.createElement(s,{src:n.images[0]?"data:image/jpeg;base64,"+n.images[0]:O}),a.createElement(m,null,a.createElement(u,null,n.title),a.createElement(p,null,(null===(t=n.publishDate)||void 0===t?void 0:t.split("T")[0])||"Дата не указана"),r&&a.createElement(h,null,n.content)))},P="https://mini-pims.ru";var L=n(848),W=n(5673);const M=(0,L.LC)({reducerPath:"userApi",baseQuery:(0,W.ni)({baseUrl:P}),endpoints:e=>({authorize:e.mutation({query:e=>{let{dto:{tgId:t,phoneNumber:n,firstName:a,lastName:r,username:i,photoUrl:l,authDate:o,hash:c},file:s}=e;return{url:"/api/auth/telegram",method:"POST",body:{tgId:t,phoneNumber:n,firstName:a,lastName:r,username:i,photoUrl:l,authDate:o,hash:c}}}}),registration:e.mutation({query:e=>{let{dto:{tgId:t,phoneNumber:n,firstName:a,lastName:r,username:i,photoUrl:l,authDate:o,hash:c},file:s}=e;return{url:"/api/users/register",method:"POST",body:{tgId:t,phoneNumber:n,firstName:a,lastName:r,username:i,photoUrl:l,authDate:o,hash:c}}}}),getNews:e.query({query:e=>({url:"/api/news/all",params:{page:0,size:100},headers:{Authorization:`Bearer ${e}`}})}),getLocation:e.query({query:e=>({url:"/api/location/all",params:{page:0,size:100},headers:{Authorization:`Bearer ${e}`}})}),getProfile:e.query({query:e=>{let{userToken:t,userUid:n}=e;return{url:`/api/users/tgprofile/${n}`,params:{tgId:n},headers:{Authorization:`Bearer ${t}`}}}})})}),U=n.p+"8da3d74f5025e24e5c2c.png",_=n.p+"7618ac51edaed6e10574.png",R=n.p+"ce75233beebc7dc37978.png",q=e=>{var t;let{}=e;const{Container:n,Title:r,Main:i,BackCircle:c,ImageAbsolute:s}=(()=>{const e=o();return{Container:l.Z.div({padding:"2.5em 1em 5px",display:"flex",flexDirection:"column",gap:"2.5em",maxHeight:"calc(100vh - 80px)",position:"relative"}),BackCircle:l.Z.div({position:"absolute",width:"100%",aspectRatio:2,top:"0",left:"50%",transform:"translate(-50%, 40%)",borderRadius:"50%",filter:"blur(70px)",backgroundColor:"#FFF2D3",zIndex:0}),Title:l.Z.div({textAlign:"center",fontWeight:600,fontSize:"2.5em",zIndex:1}),Main:l.Z.div({display:"flex",flexDirection:"column",gap:"1em",overflow:"auto",zIndex:1,borderRadius:10}),ImageAbsolute:l.Z.img({position:"fixed",height:"1em"}),size:e}})(),d=m((e=>e.userState.token)),u=M.useGetNewsQuery(d),p=m((e=>e.activeSectionState.activeNews));return a.createElement(n,null,a.createElement(r,null,"PIMS News"),a.createElement(c,null),p?a.createElement(s,{style:{top:"6.25em",left:"0.5em"},src:R}):a.createElement(a.Fragment,null,a.createElement(s,{style:{top:"0.5em",left:"0.5em"},src:U}),a.createElement(s,{style:{top:"6.25em",right:"0.5em"},src:_})),a.createElement(i,null,p?a.createElement(F,{item:p,full:!0}):null===(t=u.data)||void 0===t?void 0:t.content.map(((e,t)=>a.createElement(F,{key:t,item:e})))))},$=n.p+"658c0c62d849f7aa6d9a.png",H=n.p+"2637087ee438bf3ef819.png",V=n.p+"469e29c2715fcbf86cd9.png",G=n.p+"8273d7e3ef5e93c0ead4.png",Q=e=>{var t;let{user:n}=e;const{Container:r,Title:i,Main:c,Achievement:s,AchievementTitle:m,AchievementText:d}=(()=>{const e=o();return{Container:l.Z.div({marginTop:"2em",display:"flex",flexDirection:"column",gap:"2em",zIndex:"1",width:"100%"}),Title:l.Z.div({fontSize:"1.5em",fontWeight:600,textAlign:"center"}),Main:l.Z.div({display:"flex",gap:"1em",flexWrap:"wrap"}),Achievement:l.Z.div({width:"calc((100% - 2em) / 3)",aspectRatio:1,display:"flex",flexDirection:"column",justifyContent:"space-between",padding:"1em",borderRadius:10,"&.type1":{backgroundColor:"#EBEBEB"},"&.type2":{backgroundColor:"#fff"},"&.type3":{backgroundColor:"#FA8E7C"},"&.type4":{backgroundColor:"#FFE4D3"},"&.type5":{backgroundColor:"#FCB9A7"}}),AchievementTitle:l.Z.div({fontSize:"1.2em",fontWeight:700}),AchievementText:l.Z.div({fontWeight:600,fontSize:"0.875em"}),size:e}})(),u=null==n?void 0:n.employeeAwards.map((e=>function(){const e=[1,1,1,2,2,3,4,5],t=Math.floor(Math.random()*e.length);return e[t]}()));return a.createElement(r,null,a.createElement(i,null,"Your achievements"),a.createElement(c,null,null==n||null===(t=n.employeeAwards)||void 0===t?void 0:t.map(((e,t)=>a.createElement(s,{className:`type${u[t]}`},a.createElement(m,null,e.awardTitle),a.createElement(d,null,e.awardDescription)))),0==(null==n?void 0:n.employeeAwards.length)&&a.createElement("div",{style:{textAlign:"center",width:"100%"}},"Пока что здесь пусто")))};const X=n.p+"9e9518e6d175c8e46e37.png",J=e=>{let{}=e;const t=window.Telegram.WebApp,{Container:n,BackCircle:r,ImageAbsolute:i,Avatar:c,UserName:s,Phone:d}=(()=>{const e=o();return{Container:l.Z.div({padding:"3.5em 1em 5px",display:"flex",flexDirection:"column",alignItems:"center",justifyItems:"center",gap:"1em",height:"calc(100vh - 80px)",maxHeight:"calc(100vh - 80px)",position:"relative",overflow:"auto"}),BackCircle:l.Z.div({position:"absolute",width:"100%",aspectRatio:1.25,top:"0",left:"50%",transform:"translate(-50%, 10%)",borderRadius:"50%",filter:"blur(70px)",backgroundColor:"#FFF2D395",zIndex:0}),Avatar:l.Z.img({width:"30vw",minWidth:"30vw",minHeight:"30vw",aspectRatio:1,zIndex:1,boxShadow:"0 0 3px 1px #00000010",borderRadius:"50%",overflow:"hidden"}),UserName:l.Z.div({zIndex:1,fontSize:"1.75em",fontWeight:600,textAlign:"center"}),Phone:l.Z.div({zIndex:1,fontSize:"1.75em",fontWeight:600,textAlign:"center"}),ImageAbsolute:l.Z.img({position:"fixed",height:"1em"}),size:e}})(),u=m((e=>e.userState.token)),p=M.useGetProfileQuery({userToken:u,userUid:t.initDataUnsafe.user.id});return a.createElement(n,null,a.createElement(r,null),a.createElement(c,{style:{background:`url(${X}) 100%/100%`},src:`https://t.me/i/userpic/160/${t.initDataUnsafe.user.id}.jpg`,onLoad:e=>{e.target.width<10&&(e.target.src=X)}}),a.createElement(s,null,t.initDataUnsafe.user.first_name," ",t.initDataUnsafe.user.last_name),a.createElement(d,null,"Не указан"),a.createElement(Q,{user:p.data}),a.createElement(i,{style:{bottom:"6em",right:"1em"},src:$}),a.createElement(i,{style:{top:"0em",right:"0",height:"10em"},src:H}),a.createElement(i,{style:{top:"1.5em",left:"30%",height:"3em"},src:G}),a.createElement(i,{style:{bottom:"40%",left:"0",height:"12em"},src:V}))},Y=e=>{var t;let{item:n,itemNum:r}=e;const{Container:i,TextBox:c,Title:s,Text:m,MainContent:d}=(()=>{const e=o();return{Container:l.Z.div({borderRadius:"10px",overflow:"hidden",minHeight:"fit-content"}),TextBox:l.Z.div({background:"#fff",display:"flex",flexDirection:"column",gap:"0.25em",padding:"0.5em 1em"}),Title:l.Z.div({fontSize:"1.25em",fontWeight:600}),Text:l.Z.div({fontSize:"0.875em",transition:"0.3s","&.hide":{overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",height:"1em"},"&.open":{height:"fit-content"}}),MainContent:l.Z.div({fontSize:"0.875em"}),size:e}})();return a.createElement(i,null,a.createElement(c,null,a.createElement(s,null,r,".","  ",n.name),a.createElement(m,{onClick:e=>{e.target.className.includes("hide")?(e.target.classList.add("open"),e.target.classList.remove("hide")):(e.target.classList.remove("open"),e.target.classList.add("hide"))},className:"hide"},"Награды: ",0==n.locationAwards.length?"Пока нет":""," ",null===(t=n.locationAwards)||void 0===t?void 0:t.map((e=>e.awardTitle+", ")))))},K=n.p+"a461ed800ec704145e36.png",ee=e=>{var t;let{}=e;const{Container:n,Title:r,Main:i,BackCircle:c,ImageAbsolute:s}=(()=>{const e=o();return{Container:l.Z.div({padding:"2.5em 1em 5px",display:"flex",flexDirection:"column",gap:"2.5em",maxHeight:"calc(100vh - 80px)",position:"relative"}),BackCircle:l.Z.div({position:"absolute",width:"100%",aspectRatio:2,top:"0",left:"50%",transform:"translate(-50%, 40%)",borderRadius:"50%",filter:"blur(70px)",backgroundColor:"#FFF2D3",zIndex:0}),Title:l.Z.div({textAlign:"center",fontWeight:600,fontSize:"2.5em",zIndex:1}),Main:l.Z.div({display:"flex",flexDirection:"column",gap:"5px",overflow:"auto",zIndex:1,borderRadius:10}),ImageAbsolute:l.Z.img({position:"fixed",height:"1em"}),size:e}})(),d=m((e=>e.userState.token)),u=M.useGetLocationQuery(d);return a.createElement(n,null,a.createElement(r,null,"Locations Rating"),a.createElement(c,null),a.createElement(s,{style:{bottom:"8em",left:"50%",transform:"translate(-50%)"},src:K}),a.createElement(s,{style:{top:"0em",right:"0",height:"7em"},src:H}),a.createElement(s,{style:{bottom:"10em",left:"0",height:"12em"},src:V}),a.createElement(i,null,null===(t=u.data)||void 0===t?void 0:t.content.map(((e,t)=>a.createElement(Y,{key:t,item:e,itemNum:t+1})))))},te=()=>{const{Container:e}=D(),t=m((e=>e.activeSectionState.section));return"news"==t?a.createElement(q,null):"profile"==t?a.createElement(J,null):"raiting"==t?a.createElement(ee,null):void 0};var ne=n(3537),ae=n(540),re=n(3577),ie=n(6545),le=n(6052),oe=n(1107),ce=n(7046),se=n(5044),me=n(4646),de=n(5475),ue=n(6526),pe=n(4938),he=n(2655);const fe=()=>{const e=o();return{Container:l.Z.div({}),FromWrapper:l.Z.div({display:"flex",flexDirection:"column",gap:"1em",width:"40vw"}),FormLoginBox:l.Z.div({display:"flex",alignItems:"center",justifyContent:"center",width:"100%",height:"100vh"}),FormLoginBox:l.Z.div({display:"flex",alignItems:"center",justifyContent:"center",width:"100%",height:"100vh"}),size:e}},ge=()=>{const e=o();return{Container:l.Z.div({display:"flex",flexDirection:"column",gap:"5em"}),Item:l.Z.div({display:"flex",flexDirection:"column",gap:"1em"}),ItemTitle:l.Z.div({}),CardList:l.Z.div({display:"flex",gap:"calc((80vw - 19vw * 4) / 3)",flexWrap:"wrap",justifyContent:"space-between"}),FromWrapper:l.Z.div({display:"flex",flexDirection:"column",gap:"1em",width:"40vw"}),FormLoginBox:l.Z.div({display:"flex",alignItems:"center",justifyContent:"center",width:"100%",height:"100vh"}),size:e}};var ve=n(7318),Ee=n(1101),we=n(6032),ye=n(765),be=n(8945),xe=n(5879),Ze=n(7807),Ce=n(7233),Se=n(3255),Ae=n(7630),Ie=n(714),ke=n(8646),ze=n(9598),Te=n(8928),Be=n(4202),Ne=n(6910),je=n(2861);const De=e=>{let{content:t,actions:n,names:r,typeCard:i,initChip:l,confirmButton:o}=e;return a.createElement(ye.Z,{sx:{flex:"0 0 19vw",width:"80vw",minWidth:"19vw",maxWidth:"19vw"}},a.createElement(Ze.Z,null,a.createElement(xe.Z,{component:"img",height:"140",image:t.image?t.image:O,alt:"green iguana"}),a.createElement(be.Z,null,a.createElement(ce.Z,{gutterBottom:!0,variant:"h5",component:"div"},t.title),a.createElement(ce.Z,{variant:"body2",sx:{color:"text.secondary"}},t.text),t.text2&&a.createElement(ce.Z,{variant:"body2",sx:{color:"text.secondary"}},t.text2))),n&&r?a.createElement(Ce.Z,null,a.createElement(Pe,{names:r,initChip:l,typeCard:i})):"",o?a.createElement(Le,{confirmButton:o}):"")},Oe={PaperProps:{style:{maxHeight:224}}};function Fe(e,t,n){return{fontWeight:t.includes(e)?n.typography.fontWeightMedium:n.typography.fontWeightRegular}}function Pe(e){let{names:t,initChip:n,typeCard:r}=e;const i=(0,Se.Z)(),l=(d(),m((e=>e.adminState.token))),[o,c]=a.useState(n||[]);return a.createElement("div",null,a.createElement(ze.Z,{sx:{m:1,width:"calc(19vw - 2em)"}},a.createElement(Ie.Z,{id:"demo-multiple-chip-label"},"Chip"),a.createElement(Te.Z,{labelId:"demo-multiple-chip-label",id:"demo-multiple-chip",multiple:!0,value:o,onChange:e=>{const{target:{value:n}}=e,a=t.find((e=>e.title==n[n.length-1])),i=null==a?void 0:a.id,o=null==a?void 0:a.targetId;i&&o&&("user"==r?(async(e,t,n,a)=>{await je.Z.post(P+"/api/admin/assign-user-award",{awardId:n,targetId:a},{headers:{Authorization:`Bearer ${t}`}})})(0,l,i,o):(async(e,t,n,a)=>{await je.Z.post(P+"/api/admin/assign-location-award",{awardId:n,targetId:a},{headers:{Authorization:`Bearer ${t}`}})})(0,l,i,o)),c("string"==typeof n?n.split(","):n)},input:a.createElement(Ae.Z,{id:"select-multiple-chip",label:"Chip"}),renderValue:e=>a.createElement(ne.Z,{sx:{display:"flex",flexWrap:"wrap",gap:.5}},e.map((e=>a.createElement(Be.Z,{key:e,label:e})))),MenuProps:Oe},t.map((e=>a.createElement(ke.Z,{key:e.id,value:e.title,style:Fe(e.title,o,i)},e.title))))))}function Le(e){let{confirmButton:t}=e;return a.createElement("div",{style:{display:"flex",gap:"2em",margin:"1em"}},a.createElement(Ne.Z,{style:{flex:"1 1"},onClick:()=>{t.confirmFn()},variant:"contained",color:"success"},"Подтвердить"),a.createElement(Ne.Z,{style:{flex:"1 1"},onClick:()=>{t.rejectFn()},variant:"contained",color:"error"},"Отклонить"))}var We=n(6917),Me=n(5466),Ue=n(7536);const _e=(0,L.LC)({reducerPath:"adminApi",baseQuery:(0,W.ni)({baseUrl:P}),endpoints:e=>({getNews:e.query({query:e=>({url:"/api/news/all",params:{page:0,size:100},headers:{Authorization:`Bearer ${e}`}})}),getLocation:e.query({query:e=>({url:"/api/location/all",params:{page:0,size:100},headers:{Authorization:`Bearer ${e}`}})}),getUsers:e.query({query:e=>({url:"/api/users/all",params:{page:0,size:100},headers:{Authorization:`Bearer ${e}`}})}),getAwards:e.query({query:e=>({url:"/api/awards/all",params:{page:0,size:100},headers:{Authorization:`Bearer ${e}`}})}),getPendingApprovals:e.query({query:e=>({url:"/api/admin/pending-approvals",headers:{Authorization:`Bearer ${e}`}})})})});function Re(){return Re=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Re.apply(this,arguments)}const qe=e=>{let{}=e;const{Container:t,Item:n,ItemTitle:r,CardList:i}=ge(),l=m((e=>e.adminState.token)),{data:o}=_e.useGetUsersQuery(l)||[],{data:c,refetch:s}=_e.useGetLocationQuery(l)||[],{data:d}=_e.useGetAwardsQuery(l)||[];return a.createElement(t,null,a.createElement(ve.Z,{style:{marginBottom:"-3em"}}),a.createElement(n,null,a.createElement(ce.Z,{variant:"h5"},"Локации"),a.createElement(ve.Z,null),a.createElement(ce.Z,null,"Создать новую"),a.createElement(He,{refetch:s}),a.createElement(ve.Z,null),a.createElement(ce.Z,null,"Список существующих"),a.createElement(i,null,0==(null==c?void 0:c.content.length)&&a.createElement(a.Fragment,null,"Пока что пусто"),null==c?void 0:c.content.map(((e,t)=>{var n;return a.createElement(De,{key:e.name+t,actions:!0,content:{title:e.name,text:e.address,image:"data:image/jpeg;base64,"+e.locationImage},names:null==d?void 0:d.content.map((t=>({title:t.name,id:t.id,targetId:e.id}))),initChip:null===(n=e.locationAwards)||void 0===n?void 0:n.map((e=>e.awardTitle))})})))),a.createElement(n,null,a.createElement(ce.Z,{variant:"h5"},"Сотрудники"),a.createElement(i,null,0==(null==o?void 0:o.content.length)&&a.createElement(a.Fragment,null,"Пока что пусто"),null==o?void 0:o.content.map(((e,t)=>{var n;return a.createElement(De,{actions:!0,key:t,content:{title:e.firstName+" "+e.lastName,text:e.phone},names:null==d?void 0:d.content.map((t=>({title:t.name,id:t.id,targetId:e.id}))),typeCard:"user",initChip:null===(n=e.employeeAwards)||void 0===n?void 0:n.map((e=>e.awardTitle))})})))))},$e=(0,We.ZP)("input")({clip:"rect(0 0 0 0)",clipPath:"inset(50%)",height:1,overflow:"hidden",position:"absolute",bottom:0,left:0,whiteSpace:"nowrap",width:1});function He(e){let{refetch:t}=e;const n=m((e=>e.adminState.token)),{FromWrapper:r,FormLoginBox:i}=(d(),ge()),l=(0,Ue.cI)(),{handleSubmit:o,register:c,control:s}=l;return a.createElement(ne.Z,{component:"form",sx:{"& .MuiTextField-root":{m:1,width:"25ch"}},noValidate:!0,autoComplete:"off",onSubmit:o((e=>{(async(e,t,n,a,r,i)=>{const l=JSON.stringify({name:n,address:a}),o=new FormData;o.append("location",new Blob([l],{type:"application/json"})),o.append("file",r[0]),await je.Z.post(P+"/api/admin/create-location",o,{headers:{"Content-Type":"multipart/form-data",Accept:"application/json",Authorization:`Bearer ${t}`}}),i&&i()})(0,n,e.name,e.description,e.photo,t)}))},a.createElement(r,null,a.createElement(Ee.Z,Re({style:{width:"40vw",margin:"0"},label:"Название",id:"outlined-size-small",size:"small"},c("name",{required:!0}))),a.createElement(Ee.Z,Re({style:{width:"40vw",margin:"0"},label:"Описание",id:"outlined-size-small",size:"small"},c("description",{required:!0}))),a.createElement(Ne.Z,{style:{width:"40vw"},component:"label",role:void 0,variant:"contained",tabIndex:-1,startIcon:a.createElement(Me.Z,null)},"Добавить фото",a.createElement($e,Re({type:"file"},c("photo",{required:!0}),{multiple:!0}))),a.createElement(Ve,{control:s})))}function Ve(e){let{control:t}=e;const n=(0,Ue.cl)({control:t});return a.createElement(we.Z,{direction:"row",spacing:2},a.createElement(Ne.Z,{type:"submit",style:{width:"40vw"},variant:"contained",disabled:!n.isValid},"Создать"))}function Ge(){return Ge=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Ge.apply(this,arguments)}const Qe=e=>{let{}=e;const{Container:t,Item:n,ItemTitle:r,CardList:i}=ge(),l=m((e=>e.adminState.token)),{data:o,refetch:c}=_e.useGetAwardsQuery(l)||[];return a.createElement(t,null,a.createElement(ve.Z,{style:{marginBottom:"-3em"}}),a.createElement(n,null,a.createElement(ce.Z,{variant:"h5"},"Создать новую награду"),a.createElement(Je,{refetch:c})),a.createElement(n,null,a.createElement(ce.Z,{variant:"h5"},"Уже существующие награды"),a.createElement(i,null,0==(null==o?void 0:o.content.length)&&a.createElement(a.Fragment,null,"Пока что пусто"),null==o?void 0:o.content.map((e=>a.createElement(De,{key:e.id,content:{title:e.name,text:e.description,image:"data:image/jpeg;base64,"+e.awardImage}}))))))},Xe=(0,We.ZP)("input")({clip:"rect(0 0 0 0)",clipPath:"inset(50%)",height:1,overflow:"hidden",position:"absolute",bottom:0,left:0,whiteSpace:"nowrap",width:1});function Je(e){let{refetch:t}=e;const n=m((e=>e.adminState.token)),{FromWrapper:r,FormLoginBox:i}=(d(),ge()),l=(0,Ue.cI)(),{handleSubmit:o,register:c,control:s}=l;return a.createElement(ne.Z,{component:"form",sx:{"& .MuiTextField-root":{m:1,width:"25ch"}},noValidate:!0,autoComplete:"off",onSubmit:o((e=>{(async(e,t,n,a,r,i)=>{const l=JSON.stringify({name:n,description:a}),o=new FormData;o.append("dto",new Blob([l],{type:"application/json"})),o.append("file",r[0]),await je.Z.post(P+"/api/admin/create-award",o,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${t}`}}),i&&i()})(0,n,e.name,e.description,e.photo,t)}))},a.createElement(r,null,a.createElement(Ee.Z,Ge({style:{width:"40vw",margin:"0"},label:"Название",id:"outlined-size-small",size:"small"},c("name",{required:!0}))),a.createElement(Ee.Z,Ge({style:{width:"40vw",margin:"0"},label:"Описание",id:"outlined-size-small",size:"small"},c("description",{required:!0}))),a.createElement(Ne.Z,{style:{width:"40vw"},component:"label",role:void 0,variant:"contained",tabIndex:-1,startIcon:a.createElement(Me.Z,null)},"Добавить фото",a.createElement(Xe,Ge({type:"file"},c("photo",{required:!0}),{multiple:!0}))),a.createElement(Ye,{control:s})))}function Ye(e){let{control:t}=e;const n=(0,Ue.cl)({control:t});return a.createElement(we.Z,{direction:"row",spacing:2},a.createElement(Ne.Z,{type:"submit",style:{width:"40vw"},variant:"contained",disabled:!n.isValid},"Создать"))}function Ke(){return Ke=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Ke.apply(this,arguments)}const et=e=>{let{}=e;const{Container:t,Item:n,ItemTitle:r,CardList:i}=ge(),l=m((e=>e.adminState.token)),{data:o,refetch:c}=_e.useGetNewsQuery(l)||[];return a.createElement(t,null,a.createElement(ve.Z,{style:{marginBottom:"-3em"}}),a.createElement(n,null,a.createElement(ce.Z,{variant:"h5"},"Создать новость"),a.createElement(nt,{refetch:c})),a.createElement(n,null,a.createElement(ce.Z,{variant:"h5"},"Уже существующие новости"),a.createElement(i,null,0==(null==o?void 0:o.content.length)&&a.createElement(a.Fragment,null,"Пока что пусто"),null==o?void 0:o.content.map((e=>a.createElement(De,{key:e.id,content:{title:e.title,text:e.content,text2:e.creator,image:"data:image/jpeg;base64,"+e.images[0]}}))))))},tt=(0,We.ZP)("input")({clip:"rect(0 0 0 0)",clipPath:"inset(50%)",height:1,overflow:"hidden",position:"absolute",bottom:0,left:0,whiteSpace:"nowrap",width:1});function nt(e){let{refetch:t}=e;const n=m((e=>e.adminState.token)),{FromWrapper:r,FormLoginBox:i}=(d(),ge()),l=(0,Ue.cI)(),{handleSubmit:o,register:c,control:s}=l;return a.createElement(ne.Z,{component:"form",sx:{"& .MuiTextField-root":{m:1,width:"25ch"}},noValidate:!0,autoComplete:"off",onSubmit:o((e=>{(async(e,t,n,a,r,i,l)=>{const o=JSON.stringify({title:n,description:a,creator:r}),c=new FormData;c.append("dto",new Blob([o],{type:"application/json"})),c.append("file",i[0]),await je.Z.post(P+"/api/admin/add-news",c,{headers:{Authorization:`Bearer ${t}`,"Content-Type":"multipart/form-data",Accept:"application/json"}}),l&&l()})(0,n,e.name,e.description,e.creator,e.photo,t)}))},a.createElement(r,null,a.createElement(Ee.Z,Ke({style:{width:"40vw",margin:"0"},label:"Название",id:"outlined-size-small",size:"small"},c("name",{required:!0}))),a.createElement(Ee.Z,Ke({style:{width:"40vw",margin:"0"},label:"Описание",id:"outlined-size-small",size:"small"},c("description",{required:!0}))),a.createElement(Ee.Z,Ke({style:{width:"40vw",margin:"0"},label:"Автор",id:"outlined-size-small",size:"small"},c("creator",{required:!0}))),a.createElement(Ne.Z,{style:{width:"40vw"},component:"label",role:void 0,variant:"contained",tabIndex:-1,startIcon:a.createElement(Me.Z,null)},"Добавить фото",a.createElement(tt,Ke({type:"file"},c("photo",{required:!0}),{multiple:!0}))),a.createElement(at,{control:s})))}function at(e){let{control:t}=e;const n=(0,Ue.cl)({control:t});return a.createElement(we.Z,{direction:"row",spacing:2},a.createElement(Ne.Z,{type:"submit",style:{width:"40vw"},variant:"contained",disabled:!n.isValid},"Создать"))}const rt=e=>{let{}=e;d();const{Container:t,Item:n,ItemTitle:r,CardList:i}=ge(),l=m((e=>e.adminState.token)),{data:o,refetch:c}=_e.useGetPendingApprovalsQuery(l)||[];return a.createElement(t,null,a.createElement(ve.Z,{style:{marginBottom:"-3em"}}),a.createElement(n,null,a.createElement(ce.Z,{variant:"h5"},"Не подтверждённые пользователи"),a.createElement(i,null,0==(null==o?void 0:o.length)&&a.createElement(a.Fragment,null,"Пока что пусто"),null==o?void 0:o.map(((e,t)=>a.createElement(De,{key:t,confirmButton:{confirmFn:()=>{(async(e,t,n,a)=>{await je.Z.post(`https://mini-pims.ru/api/admin/approve-user/${n}`,{userId:n},{headers:{Authorization:`Bearer ${t}`}}).then((e=>{a&&a()})).catch((e=>{a&&a()}))})(0,l,e.id,c)},rejectFn:()=>{(async(e,t,n,a)=>{await je.Z.post(`https://mini-pims.ru/api/admin/decline-registration/${n}`,{userId:n},{headers:{Authorization:`Bearer ${t}`}}).then((e=>{a&&a()})).catch((e=>{a&&a()}))})(0,l,e.id,c)}},content:{title:e.firstName+" "+e.lastName,text:e.phone,image:`https://t.me/i/userpic/160/${e.telegramId}.jpg`}}))))))},it=e=>{let{activeSection:t}=e;const{Container:n}=fe();return"AssignReward"==t?a.createElement(n,null,a.createElement(qe,null)):"AddAwards"==t?a.createElement(n,null,a.createElement(Qe,null)):"News"==t?a.createElement(n,null,a.createElement(et,null)):"ApprovalRegistrations"==t?a.createElement(n,null,a.createElement(rt,null)):void 0};var lt=n(8121);function ot(){const e=(()=>{const e=d();return()=>{e(A(""))}})();return a.createElement(we.Z,{direction:"row",spacing:2},a.createElement(Ne.Z,{onClick:()=>{e()},variant:"contained",endIcon:a.createElement(lt.Z,null)},"Выйти"))}function ct(){return ct=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},ct.apply(this,arguments)}function st(){const e=d(),{FromWrapper:t,FormLoginBox:n}=fe(),r=(0,Ue.cI)(),{handleSubmit:i,register:l,control:o}=r;return a.createElement(n,null,a.createElement(ne.Z,{component:"form",sx:{"& .MuiTextField-root":{m:1,width:"25ch"}},noValidate:!0,autoComplete:"off",onSubmit:i((t=>{(async(e,t,n)=>{const a=await je.Z.post(P+"/api/auth/admin",{username:t,password:n});e(A(a.data.token)),a.data})(e,t.userName,t.pass)}))},a.createElement(t,null,a.createElement(ce.Z,{variant:"h5"},"Авторизация"),a.createElement(Ee.Z,ct({style:{width:"40vw",margin:"0"},label:"Имя пользователя",id:"outlined-size-small",size:"small"},l("userName",{required:!0}))),a.createElement(Ee.Z,ct({style:{width:"40vw",margin:"0"},label:"Пароль",id:"outlined-size-small",size:"small"},l("pass",{required:!0}))),a.createElement(mt,{control:o}))))}function mt(e){let{control:t}=e;const n=(0,Ue.cl)({control:t});return a.createElement(we.Z,{direction:"row",spacing:2},a.createElement(Ne.Z,{type:"submit",style:{width:"40vw"},variant:"contained",disabled:!n.isValid},"Войти"))}const dt=["Присвоить награду","Доп. Награды","Новости","Одобрение регистраций"],ut=["AssignReward","AddAwards","News","ApprovalRegistrations"];function pt(){const[e,t]=a.useState("AssignReward");return""==m((e=>e.adminState.token))?a.createElement(st,null):a.createElement(ne.Z,{sx:{display:"flex"}},a.createElement(ie.ZP,null),a.createElement(re.Z,{position:"fixed",sx:{zIndex:e=>e.zIndex.drawer+1}},a.createElement(le.Z,{style:{justifyContent:"space-between"}},a.createElement(ce.Z,{variant:"h6",noWrap:!0,component:"div"},"Админ панель"),a.createElement(ot,null))),a.createElement(ae.ZP,{variant:"permanent",sx:{width:240,flexShrink:0,"& .MuiDrawer-paper":{width:240,boxSizing:"border-box"}}},a.createElement(le.Z,null),a.createElement(ne.Z,{sx:{overflow:"auto"}},a.createElement(oe.Z,null,dt.map(((e,n)=>a.createElement(se.ZP,{key:e,disablePadding:!0,onClick:()=>{t(ut[n])}},a.createElement(me.Z,null,a.createElement(de.Z,null,n%2==0?a.createElement(pe.Z,null):a.createElement(he.Z,null)),a.createElement(ue.Z,{primary:e})))))))),a.createElement(ne.Z,{component:"main",sx:{flexGrow:1,p:3,overflow:"auto",maxHeight:"caLC(100vh - 64px)"},className:"scrollbar"},a.createElement(le.Z,null),a.createElement(ce.Z,{variant:"h4",sx:{marginBottom:2}},dt[ut.findIndex((t=>t==e))]),a.createElement(it,{activeSection:e})))}const ht=(0,u.oM)({name:"authBlurState",initialState:{blur:!1},reducers:{setAuthBlur:(e,t)=>{let{payload:n}=t;e.blur=n}}}),{setAuthBlur:ft}=ht.actions,gt=ht,vt=(0,u.oM)({name:"userState",initialState:{token:""},reducers:{setUserToken:(e,t)=>{let{payload:n}=t;document.cookie=`usertoken=${n}; path=/;`,e.token=n}}}),{setUserToken:Et}=vt.actions,wt=vt,yt=()=>{const{pathname:e}=(0,i.TH)();return e.includes("admin")||(()=>{const e=window.Telegram.WebApp,t=d();console.log(e.initDataUnsafe);const n={dto:{tgId:e.initDataUnsafe.user.id,phoneNumber:e.initDataUnsafe.user.phone_number||"",firstName:e.initDataUnsafe.user.first_name,lastName:e.initDataUnsafe.user.last_name,username:e.initDataUnsafe.user.username,photoUrl:`https://t.me/i/userpic/160/${e.initDataUnsafe.user.id}.jpg`,authDate:e.initDataUnsafe.auth_date,hash:e.initDataUnsafe.hash},file:""},[r,i]=M.useAuthorizeMutation(),[l,o]=M.useRegistrationMutation();(0,a.useEffect)((()=>{r(n)}),[]),(0,a.useEffect)((()=>{i.error?("Current user is not registered"==i.error.data&&l(n),"Current user is not approved by admin"==i.error.data&&t(ft(!0))):i.data&&t(Et(i.data.token))}),[i]),(0,a.useEffect)((()=>{o.data&&200==o.data.originalStatus&&t(ft(!0))}),[o])})(),(0,a.useEffect)((()=>{const e=localStorage.getItem("lastReload"),t=Math.floor((new Date).getTime()/1e3);(null==e||+e+2<t)&&(localStorage.setItem("lastReload",`${t}`),location.reload())}),[]),a.createElement(i.Z5,null,a.createElement(i.AW,{path:"/",element:a.createElement(N,null)},a.createElement(i.AW,{index:!0,element:a.createElement(te,null)}),a.createElement(i.AW,{path:"admin",element:a.createElement(pt,null)})))};var bt=n(9655);const xt=(0,n(4791).UY)({[wt.name]:wt.reducer,[y.name]:y.reducer,[z.name]:z.reducer,[g.name]:g.reducer,[gt.name]:gt.reducer,[_e.reducerPath]:_e.reducer,[M.reducerPath]:M.reducer}),Zt=(0,u.xC)({reducer:xt,middleware:e=>e().concat(_e.middleware,M.middleware)},window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__());var Ct=n(4155);const St=document.querySelector("#wrap");(0,r.s)(St).render(a.createElement(bt.VK,{basemname:`/${Ct.env.PUBLIC_URL}`},a.createElement(s.zt,{store:Zt},a.createElement(yt,null))))}},r={};function i(e){var t=r[e];if(void 0!==t)return t.exports;var n=r[e]={exports:{}};return a[e](n,n.exports,i),n.exports}i.m=a,e=[],i.O=(t,n,a,r)=>{if(!n){var l=1/0;for(m=0;m<e.length;m++){n=e[m][0],a=e[m][1],r=e[m][2];for(var o=!0,c=0;c<n.length;c++)(!1&r||l>=r)&&Object.keys(i.O).every((e=>i.O[e](n[c])))?n.splice(c--,1):(o=!1,r<l&&(l=r));if(o){e.splice(m--,1);var s=a();void 0!==s&&(t=s)}}return t}r=r||0;for(var m=e.length;m>0&&e[m-1][2]>r;m--)e[m]=e[m-1];e[m]=[n,a,r]},i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},n=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,i.t=function(e,a){if(1&a&&(e=this(e)),8&a)return e;if("object"==typeof e&&e){if(4&a&&e.__esModule)return e;if(16&a&&"function"==typeof e.then)return e}var r=Object.create(null);i.r(r);var l={};t=t||[null,n({}),n([]),n(n)];for(var o=2&a&&e;"object"==typeof o&&!~t.indexOf(o);o=n(o))Object.getOwnPropertyNames(o).forEach((t=>l[t]=()=>e[t]));return l.default=()=>e,i.d(r,l),r},i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.p="/",(()=>{var e={179:0};i.O.j=t=>0===e[t];var t=(t,n)=>{var a,r,l=n[0],o=n[1],c=n[2],s=0;if(l.some((t=>0!==e[t]))){for(a in o)i.o(o,a)&&(i.m[a]=o[a]);if(c)var m=c(i)}for(t&&t(n);s<l.length;s++)r=l[s],i.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return i.O(m)},n=self.webpackChunkwebpack_to_study=self.webpackChunkwebpack_to_study||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var l=i.O(void 0,[690],(()=>i(8305)));l=i.O(l)})();